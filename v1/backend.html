<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>TimeonsiteTracker by saleemkce</title>

    <link rel="stylesheet" href="../stylesheets/styles.css">
    <link rel="stylesheet" href="../stylesheets/github-light.css">

    <link rel="stylesheet" href="../stylesheets/custom.css">
    <link rel="stylesheet" href="../stylesheets/sunburst.css">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
    <body>
        <div class="wrapper">
            <header>
                <h1>TimeonsiteTracker (TOS)</h1>
                <p></p>

                <p class="view"><a href="https://github.com/saleemkce/timeonsite">View the Project on GitHub <small>saleemkce/timeonsite</small></a></p>

                <p><a href="index.html">v1.0.0</a></p>

                <ul>
                  <li><a href="https://github.com/saleemkce/timeonsite/zipball/master">Download <strong>ZIP File</strong></a></li>
                  <li><a href="https://github.com/saleemkce/timeonsite/tarball/master">Download <strong>TAR Ball</strong></a></li>
                  <li><a href="https://github.com/saleemkce/timeonsite">View On <strong>GitHub</strong></a></li>
                </ul>
            </header>
            <section>
            
                <!-- <h3><a id="welcome-to-github-pages" class="anchor" href="#welcome-to-github-pages" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Welcome to GitHub Pages.</h3>

                <p>This automatic page generator is the easiest way to create beautiful pages for all of your projects. Author your page content here <a href="https://guides.github.com/features/mastering-markdown/">using GitHub Flavored Markdown</a>, select a template crafted by a designer, and publish. After your page is generated, you can check out the new <code>gh-pages</code> branch locally. If you’re using GitHub Desktop, simply sync your repository and you’ll see the new branch.</p> -->

                <h3 id="examples">Saving TOS to database - Examples</h3>

                <h3>Node.js Server-side data handling</h3>
<pre class="prettyprint lang-js">
//file 1: tos.model.js
var controller = require('tos.controller.js')

module.exports = function(app) {

    app.route('/tos')
        .post(controller.SaveTos);
};



//file 2: tos.model.js
var mongoose = require('mongoose'),
Schema = new mongoose.Schema({
    TOSId: Number,
    TOSSessionKey: String,
    title: String,
    URL: String,
    currentTime: Date,
    entryTime: Date,
    exitTime: Date,
    timeOnPage: Number,
    timeOnPageTrackedBy: String,
    timeOnSite: Number
}, {
    versionKey: false,
    strict: false
});

var TosSchema = mongoose.model('tos', Schema);
module.exports = TosSchema;



//file 3: tos.controller.js
var TosSchema = require('tos.model.js');
var c = 0;
module.exports.SaveTos = function(req, res, next) {
    var data = req.body;
    console.log(data);

    if(data && data.trackingType && data.trackingType == 'tos') {
        var Tos = new TosSchema(data);
        // Data saved to mongoDB's tos collection
        Tos.save(data, function(err){
            console.log(err);
        });

        console.log('TOS type : ' + data.trackingType);
        console.log('Record No : ' + ++c);
    } else {
        console.log('TOS data not received. Please check your endpoint URL and POST data from client-side!');
    }

    res.send('success');
    
};
</pre>

            </section>
            <footer>
                <p>This project is maintained by <a href="https://github.com/saleemkce">saleemkce</a></p>
                <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
            </footer>
        </div>
        <script src="../javascripts/scale.fix.js"></script>
        <script src="../javascripts/run_prettify.js"></script>
        
    </body>
</html>
<!-- 
html code conversion @
http://www.web2generators.com/html-based-tools/online-html-entities-encoder-and-decoder 
-->





